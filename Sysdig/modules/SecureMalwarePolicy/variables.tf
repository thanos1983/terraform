variable "name" {
  description = "The name of the Secure Team."
  type        = string
}

variable "description" {
  description = "A description of the team."
  type        = string
  default     = null
}

variable "severity" {
  description = "The severity of Secure policy."
  type        = number
  default     = 7
}

variable "enabled" {
  description = "Whether the policy is enabled or not."
  type        = bool
  default     = false
}

variable "runbook" {
  description = "Customer provided url that provides a runbook for a given policy."
  type        = string
  default     = null
}

variable "scope" {
  description = "The application scope for the policy."
  type        = string
  default     = null
}

variable "notification_channels" {
  description = "IDs of the notification channels to send alerts to when the policy is fired."
  type = list(string)
  default = []
}

variable "actions_blocks" {
  description = "The actions block is optional and supports the following parameters."
  type = list(object({
    prevent_malware = optional(bool)
    container = optional(string)
    capture_block = optional(object({
      seconds_before_event = number
      seconds_after_event  = number
      name                 = string
      filter = optional(string)
      bucket_name = optional(string)
      folder = optional(string)
    }), null)
  }))
  default = []
}

variable "rule_block" {
  description = "The rule block is required and supports the following parameters.."
  type = object({
    description        = string
    use_managed_hashes = bool
    additional_hashes_block = optional(object({
      hash = string
    }), null)
    ignore_hashes_block = optional(object({
      hash = string
    }), null)
  })
}
